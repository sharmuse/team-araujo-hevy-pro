export function getEmailCfg(){ try{ return JSON.parse(localStorage.getItem('ta_email_cfg_v1')||'{"provider":"mailto"}') }catch{ return {provider:'mailto'} } } export function setEmailCfg(cfg:any){ localStorage.setItem('ta_email_cfg_v1', JSON.stringify(cfg)); } export async function sendEmail(to:string, subject:string, message:string){ const cfg=getEmailCfg(); if(cfg.provider==='emailjs' && (window as any).emailjs && cfg.emailjs){ try{ await (window as any).emailjs.send(cfg.emailjs.serviceId, cfg.emailjs.templateId, { to, subject, message }, { publicKey: cfg.emailjs.publicKey }); return true; }catch(e){ console.error('emailjs error', e); return false; } } const url=`mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(message)}`; window.location.href=url; return true; }
